{
  "rules": {
    ".read": false,
    ".write": false,

    "presence": {
      "$uid": {
        ".read": "auth != null && auth.uid === $uid",
        ".write": "auth != null && auth.uid === $uid"
      }
    },

    "lobbies": {
      "$region": {
        "queue": {
          "$uid": {
            ".read": "auth != null && auth.uid === $uid",
            ".write": "auth != null && auth.uid === $uid"
          }
        }
      }
    },

    "battles": {
      "$battleId": {
        ".read": "auth != null && (auth.uid === root.child('battles/' + $battleId + '/meta/players/p1/uid').val() || auth.uid === root.child('battles/' + $battleId + '/meta/players/p2/uid').val())",
        ".write": "auth != null && (auth.uid === root.child('battles/' + $battleId + '/meta/players/p1/uid').val() || auth.uid === root.child('battles/' + $battleId + '/meta/players/p2/uid').val())",

        "meta": {
          ".write": false
        },

        "public": {
          ".write": false
        },

        "private": {
          "$uid": {
            ".read": "auth != null && auth.uid === $uid",
            ".write": "auth != null && auth.uid === $uid"
          }
        },

        "turns": {
          "$turn": {
            "choices": {
              "$uid": {
                ".read": "auth != null && (auth.uid === root.child('battles/' + $battleId + '/meta/players/p1/uid').val() || auth.uid === root.child('battles/' + $battleId + '/meta/players/p2/uid').val())",
                ".write": "auth != null && auth.uid === $uid"
              }
            },
            "resolution": {
              ".read": "auth != null && (auth.uid === root.child('battles/' + $battleId + '/meta/players/p1/uid').val() || auth.uid === root.child('battles/' + $battleId + '/meta/players/p2/uid').val())",
              ".write": false
            }
          }
        }
      }
    }
  }
}
