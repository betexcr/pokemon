{"numTotalTestSuites":87,"numPassedTestSuites":87,"numFailedTestSuites":0,"numPendingTestSuites":0,"numTotalTests":160,"numPassedTests":61,"numFailedTests":99,"numPendingTests":0,"numTodoTests":0,"startTime":1758701294831,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["","FirebaseRTDBBattleEngine","constructor"],"fullName":" FirebaseRTDBBattleEngine constructor should initialize with battle ID","status":"passed","title":"should initialize with battle ID","duration":1,"failureMessages":[]},{"ancestorTitles":["","FirebaseRTDBBattleEngine","initialize"],"fullName":" FirebaseRTDBBattleEngine initialize should set up listeners and mark as initialized","status":"passed","title":"should set up listeners and mark as initialized","duration":2,"failureMessages":[]},{"ancestorTitles":["","FirebaseRTDBBattleEngine","initialize"],"fullName":" FirebaseRTDBBattleEngine initialize should handle missing auth user","status":"failed","title":"should handle missing auth user","duration":7,"failureMessages":["expected \"spy\" to be called at least once","unsub is not a function","unsub is not a function"],"location":{"line":75,"column":40}},{"ancestorTitles":["","FirebaseRTDBBattleEngine","submitChoice"],"fullName":" FirebaseRTDBBattleEngine submitChoice should submit move choice","status":"failed","title":"should submit move choice","duration":1,"failureMessages":["Battle not initialized","Battle not initialized","Battle not initialized"],"location":{"line":151,"column":13}},{"ancestorTitles":["","FirebaseRTDBBattleEngine","submitChoice"],"fullName":" FirebaseRTDBBattleEngine submitChoice should submit switch choice","status":"failed","title":"should submit switch choice","duration":115,"failureMessages":["Battle not initialized","Battle not initialized","Battle not initialized"],"location":{"line":151,"column":13}},{"ancestorTitles":["","FirebaseRTDBBattleEngine","submitChoice"],"fullName":" FirebaseRTDBBattleEngine submitChoice should throw error if not initialized","status":"passed","title":"should throw error if not initialized","duration":114,"failureMessages":[]},{"ancestorTitles":["","FirebaseRTDBBattleEngine","submitChoice"],"fullName":" FirebaseRTDBBattleEngine submitChoice should throw error if not in choosing phase","status":"passed","title":"should throw error if not in choosing phase","duration":114,"failureMessages":[]},{"ancestorTitles":["","FirebaseRTDBBattleEngine","convertToBattleState"],"fullName":" FirebaseRTDBBattleEngine convertToBattleState should convert RTDB data to BattleState","status":"passed","title":"should convert RTDB data to BattleState","duration":2,"failureMessages":[]},{"ancestorTitles":["","FirebaseRTDBBattleEngine","convertToBattleState"],"fullName":" FirebaseRTDBBattleEngine convertToBattleState should throw error if not fully initialized","status":"passed","title":"should throw error if not fully initialized","duration":2,"failureMessages":["expected [Function] to throw an error"],"location":{"line":259,"column":10}},{"ancestorTitles":["","FirebaseRTDBBattleEngine","destroy"],"fullName":" FirebaseRTDBBattleEngine destroy should clean up listeners and reset state","status":"passed","title":"should clean up listeners and reset state","duration":0,"failureMessages":[]},{"ancestorTitles":["","FirebaseRTDBBattleEngine","getters"],"fullName":" FirebaseRTDBBattleEngine getters should return current phase","status":"passed","title":"should return current phase","duration":0,"failureMessages":[]},{"ancestorTitles":["","FirebaseRTDBBattleEngine","getters"],"fullName":" FirebaseRTDBBattleEngine getters should return current turn","status":"passed","title":"should return current turn","duration":0,"failureMessages":[]},{"ancestorTitles":["","FirebaseRTDBBattleEngine","getters"],"fullName":" FirebaseRTDBBattleEngine getters should return completion status","status":"passed","title":"should return completion status","duration":0,"failureMessages":[]},{"ancestorTitles":["","FirebaseRTDBBattleEngine","getters"],"fullName":" FirebaseRTDBBattleEngine getters should return winner","status":"passed","title":"should return winner","duration":0,"failureMessages":[]},{"ancestorTitles":["","BattleFlowEngine","constructor"],"fullName":" BattleFlowEngine constructor should initialize with battle ID and create RTDB engine","status":"passed","title":"should initialize with battle ID and create RTDB engine","duration":1,"failureMessages":[]},{"ancestorTitles":["","BattleFlowEngine","initialize"],"fullName":" BattleFlowEngine initialize should initialize the underlying RTDB engine","status":"passed","title":"should initialize the underlying RTDB engine","duration":0,"failureMessages":[]},{"ancestorTitles":["","BattleFlowEngine","submitMove"],"fullName":" BattleFlowEngine submitMove should submit move choice","status":"passed","title":"should submit move choice","duration":1,"failureMessages":[]},{"ancestorTitles":["","BattleFlowEngine","submitMove"],"fullName":" BattleFlowEngine submitMove should submit move without target","status":"passed","title":"should submit move without target","duration":1,"failureMessages":[]},{"ancestorTitles":["","BattleFlowEngine","submitSwitch"],"fullName":" BattleFlowEngine submitSwitch should submit switch choice","status":"passed","title":"should submit switch choice","duration":1,"failureMessages":[]},{"ancestorTitles":["","BattleFlowEngine","getBattleState"],"fullName":" BattleFlowEngine getBattleState should return null if not initialized","status":"passed","title":"should return null if not initialized","duration":2,"failureMessages":[]},{"ancestorTitles":["","BattleFlowEngine","getBattleState"],"fullName":" BattleFlowEngine getBattleState should return battle state if initialized","status":"failed","title":"should return battle state if initialized","duration":4,"failureMessages":["expected null to be { player: { pokemon: [], …(3) }, …(8) } // Object.is equality","expected null to be { player: { pokemon: [], …(3) }, …(8) } // Object.is equality","expected null to be { player: { pokemon: [], …(3) }, …(8) } // Object.is equality"],"location":{"line":459,"column":22}},{"ancestorTitles":["","BattleFlowEngine","destroy"],"fullName":" BattleFlowEngine destroy should destroy the underlying RTDB engine","status":"passed","title":"should destroy the underlying RTDB engine","duration":1,"failureMessages":[]}],"startTime":1758701296144,"endTime":1758701296278,"status":"failed","message":"","name":"/Users/albertomunoz/Documents/Code/pokemon/src/lib/__tests__/battle-engine-rtdb.test.ts"},{"assertionResults":[{"ancestorTitles":["","Battle Flow Integration Tests","Complete Battle Flow"],"fullName":" Battle Flow Integration Tests Complete Battle Flow should handle full battle lifecycle from initialization to completion","status":"failed","title":"should handle full battle lifecycle from initialization to completion","duration":10,"failureMessages":["expected undefined to be 'choice' // Object.is equality","expected undefined to be 'choice' // Object.is equality","expected \"initialize\" to be called at least once"],"location":{"line":123,"column":35}},{"ancestorTitles":["","Battle Flow Integration Tests","Complete Battle Flow"],"fullName":" Battle Flow Integration Tests Complete Battle Flow should handle Pokemon switching flow","status":"failed","title":"should handle Pokemon switching flow","duration":10,"failureMessages":["Battle not initialized","Battle not initialized","Battle not initialized"],"location":{"line":151,"column":13}},{"ancestorTitles":["","Battle Flow Integration Tests","Complete Battle Flow"],"fullName":" Battle Flow Integration Tests Complete Battle Flow should handle error scenarios gracefully","status":"passed","title":"should handle error scenarios gracefully","duration":8,"failureMessages":[]},{"ancestorTitles":["","Battle Flow Integration Tests","Complete Battle Flow"],"fullName":" Battle Flow Integration Tests Complete Battle Flow should handle move submission errors","status":"failed","title":"should handle move submission errors","duration":10,"failureMessages":["expected [Function] to throw error including 'Invalid move' but got 'Battle not initialized'","expected [Function] to throw error including 'Invalid move' but got 'Battle not initialized'","expected [Function] to throw error including 'Invalid move' but got 'Battle not initialized'"],"location":{"line":249,"column":7}},{"ancestorTitles":["","Battle Flow Integration Tests","Complete Battle Flow"],"fullName":" Battle Flow Integration Tests Complete Battle Flow should handle switch submission errors","status":"failed","title":"should handle switch submission errors","duration":10,"failureMessages":["expected [Function] to throw error including 'Invalid switch' but got 'Battle not initialized'","expected [Function] to throw error including 'Invalid switch' but got 'Battle not initialized'","expected [Function] to throw error including 'Invalid switch' but got 'Battle not initialized'"],"location":{"line":271,"column":7}},{"ancestorTitles":["","Battle Flow Integration Tests","State Synchronization"],"fullName":" Battle Flow Integration Tests State Synchronization should maintain state consistency across multiple updates","status":"failed","title":"should maintain state consistency across multiple updates","duration":1,"failureMessages":["expected undefined to be 1 // Object.is equality","expected undefined to be 1 // Object.is equality","expected undefined to be 1 // Object.is equality"],"location":{"line":296,"column":49}},{"ancestorTitles":["","Battle Flow Integration Tests","State Synchronization"],"fullName":" Battle Flow Integration Tests State Synchronization should handle rapid phase changes","status":"passed","title":"should handle rapid phase changes","duration":0,"failureMessages":[]},{"ancestorTitles":["","Battle Flow Integration Tests","Cleanup and Resource Management"],"fullName":" Battle Flow Integration Tests Cleanup and Resource Management should properly clean up resources on destroy","status":"passed","title":"should properly clean up resources on destroy","duration":0,"failureMessages":[]},{"ancestorTitles":["","Battle Flow Integration Tests","Cleanup and Resource Management"],"fullName":" Battle Flow Integration Tests Cleanup and Resource Management should handle multiple destroy calls gracefully","status":"passed","title":"should handle multiple destroy calls gracefully","duration":0,"failureMessages":[]},{"ancestorTitles":["","Battle Flow Integration Tests","Edge Cases"],"fullName":" Battle Flow Integration Tests Edge Cases should handle null battle state gracefully","status":"passed","title":"should handle null battle state gracefully","duration":1,"failureMessages":[]},{"ancestorTitles":["","Battle Flow Integration Tests","Edge Cases"],"fullName":" Battle Flow Integration Tests Edge Cases should handle undefined callbacks","status":"passed","title":"should handle undefined callbacks","duration":1,"failureMessages":[]},{"ancestorTitles":["","Battle Flow Integration Tests","Edge Cases"],"fullName":" Battle Flow Integration Tests Edge Cases should handle concurrent operations","status":"failed","title":"should handle concurrent operations","duration":1,"failureMessages":["expected \"spy\" to be called 3 times, but got 0 times","expected \"spy\" to be called 3 times, but got 0 times","expected \"spy\" to be called 3 times, but got 0 times"],"location":{"line":410,"column":40}}],"startTime":1758701296663,"endTime":1758701296677,"status":"failed","message":"","name":"/Users/albertomunoz/Documents/Code/pokemon/src/lib/__tests__/battle-flow-integration.test.ts"},{"assertionResults":[{"ancestorTitles":["","Battle State Conversion Tests","RTDB to BattleState Conversion"],"fullName":" Battle State Conversion Tests RTDB to BattleState Conversion should convert basic battle state correctly","status":"failed","title":"should convert basic battle state correctly","duration":14,"failureMessages":["expected [] to have a length of 1 but got +0","expected [] to have a length of 1 but got +0","expected [] to have a length of 1 but got +0"],"location":{"line":117,"column":44}},{"ancestorTitles":["","Battle State Conversion Tests","RTDB to BattleState Conversion"],"fullName":" Battle State Conversion Tests RTDB to BattleState Conversion should handle different battle phases correctly","status":"failed","title":"should handle different battle phases correctly","duration":221,"failureMessages":["expected 'resolution' to be 'resolving' // Object.is equality","expected 'resolution' to be 'resolving' // Object.is equality","expected 'resolution' to be 'resolving' // Object.is equality"],"location":{"line":164,"column":33}},{"ancestorTitles":["","Battle State Conversion Tests","RTDB to BattleState Conversion"],"fullName":" Battle State Conversion Tests RTDB to BattleState Conversion should handle Pokemon with different HP values","status":"failed","title":"should handle Pokemon with different HP values","duration":221,"failureMessages":["Cannot read properties of undefined (reading 'currentHp')","Cannot read properties of undefined (reading 'currentHp')","Cannot read properties of undefined (reading 'currentHp')"],"location":{"line":233,"column":46}},{"ancestorTitles":["","Battle State Conversion Tests","RTDB to BattleState Conversion"],"fullName":" Battle State Conversion Tests RTDB to BattleState Conversion should handle Pokemon with stat boosts","status":"failed","title":"should handle Pokemon with stat boosts","duration":221,"failureMessages":["Cannot read properties of undefined (reading 'statModifiers')","Cannot read properties of undefined (reading 'statModifiers')","Cannot read properties of undefined (reading 'statModifiers')"],"location":{"line":291,"column":46}},{"ancestorTitles":["","Battle State Conversion Tests","RTDB to BattleState Conversion"],"fullName":" Battle State Conversion Tests RTDB to BattleState Conversion should handle field conditions","status":"passed","title":"should handle field conditions","duration":218,"failureMessages":[]},{"ancestorTitles":["","Battle State Conversion Tests","RTDB to BattleState Conversion"],"fullName":" Battle State Conversion Tests RTDB to BattleState Conversion should handle multiple Pokemon on bench","status":"passed","title":"should handle multiple Pokemon on bench","duration":2,"failureMessages":[]},{"ancestorTitles":["","Battle State Conversion Tests","RTDB to BattleState Conversion"],"fullName":" Battle State Conversion Tests RTDB to BattleState Conversion should handle fainted Pokemon correctly","status":"passed","title":"should handle fainted Pokemon correctly","duration":0,"failureMessages":[]},{"ancestorTitles":["","Battle State Conversion Tests","RTDB to BattleState Conversion"],"fullName":" Battle State Conversion Tests RTDB to BattleState Conversion should throw error if not fully initialized","status":"passed","title":"should throw error if not fully initialized","duration":1,"failureMessages":[]},{"ancestorTitles":["","Battle State Conversion Tests","RTDB to BattleState Conversion"],"fullName":" Battle State Conversion Tests RTDB to BattleState Conversion should throw error if meta is missing","status":"passed","title":"should throw error if meta is missing","duration":0,"failureMessages":[]},{"ancestorTitles":["","Battle State Conversion Tests","RTDB to BattleState Conversion"],"fullName":" Battle State Conversion Tests RTDB to BattleState Conversion should throw error if publicState is missing","status":"passed","title":"should throw error if publicState is missing","duration":0,"failureMessages":[]},{"ancestorTitles":["","Battle State Conversion Tests","RTDB to BattleState Conversion"],"fullName":" Battle State Conversion Tests RTDB to BattleState Conversion should throw error if privateState is missing","status":"passed","title":"should throw error if privateState is missing","duration":0,"failureMessages":[]}],"startTime":1758701295688,"endTime":1758701295909,"status":"failed","message":"","name":"/Users/albertomunoz/Documents/Code/pokemon/src/lib/__tests__/battle-state-conversion.test.ts"},{"assertionResults":[{"ancestorTitles":["","FirebaseRTDBService","updatePresence"],"fullName":" FirebaseRTDBService updatePresence should update user presence with connected status","status":"failed","title":"should update user presence with connected status","duration":7,"failureMessages":["expected \"spy\" to be called with arguments: [ { path: 'presence/test-uid' }, …(1) ]\n\nReceived: \n\n\n\nNumber of calls: 0\n","expected \"spy\" to be called with arguments: [ { path: 'presence/test-uid' }, …(1) ]\n\nReceived: \n\n\n\nNumber of calls: 0\n","expected \"spy\" to be called with arguments: [ Anything, 'presence/test-uid' ]\n\nReceived: \n\n\n\nNumber of calls: 0\n"],"location":{"line":50,"column":19}},{"ancestorTitles":["","FirebaseRTDBService","updatePresence"],"fullName":" FirebaseRTDBService updatePresence should update user presence with disconnected status","status":"failed","title":"should update user presence with disconnected status","duration":7,"failureMessages":["expected \"spy\" to be called with arguments: [ { path: 'presence/test-uid' }, …(1) ]\n\nReceived: \n\n\n\nNumber of calls: 0\n","expected \"spy\" to be called with arguments: [ { path: 'presence/test-uid' }, …(1) ]\n\nReceived: \n\n\n\nNumber of calls: 0\n","expected \"spy\" to be called with arguments: [ { path: 'presence/test-uid' }, …(1) ]\n\nReceived: \n\n\n\nNumber of calls: 0\n"],"location":{"line":63,"column":19}},{"ancestorTitles":["","FirebaseRTDBService","updatePresence"],"fullName":" FirebaseRTDBService updatePresence should throw error if RTDB not initialized","status":"failed","title":"should throw error if RTDB not initialized","duration":7,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":75,"column":64}},{"ancestorTitles":["","FirebaseRTDBService","joinLobby"],"fullName":" FirebaseRTDBService joinLobby should join lobby with user preferences","status":"passed","title":"should join lobby with user preferences","duration":0,"failureMessages":[]},{"ancestorTitles":["","FirebaseRTDBService","leaveLobby"],"fullName":" FirebaseRTDBService leaveLobby should remove user from lobby queue","status":"passed","title":"should remove user from lobby queue","duration":0,"failureMessages":[]},{"ancestorTitles":["","FirebaseRTDBService","createBattle"],"fullName":" FirebaseRTDBService createBattle should create battle with proper structure","status":"passed","title":"should create battle with proper structure","duration":2,"failureMessages":[]},{"ancestorTitles":["","FirebaseRTDBService","submitChoice"],"fullName":" FirebaseRTDBService submitChoice should submit choice with proper structure","status":"failed","title":"should submit choice with proper structure","duration":1,"failureMessages":["Cannot read properties of undefined (reading 'val')","Cannot read properties of undefined (reading 'val')","Cannot read properties of undefined (reading 'val')"],"location":{"line":274,"column":47}},{"ancestorTitles":["","FirebaseRTDBService","listeners"],"fullName":" FirebaseRTDBService listeners should set up battle meta listener","status":"failed","title":"should set up battle meta listener","duration":8,"failureMessages":["expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 1\n","expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 1\n","expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 1\n"],"location":{"line":239,"column":23}},{"ancestorTitles":["","FirebaseRTDBService","listeners"],"fullName":" FirebaseRTDBService listeners should set up battle public listener","status":"failed","title":"should set up battle public listener","duration":8,"failureMessages":["expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  2nd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 2\n","expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  2nd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 2\n","expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  2nd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 2\n"],"location":{"line":251,"column":23}},{"ancestorTitles":["","FirebaseRTDBService","listeners"],"fullName":" FirebaseRTDBService listeners should set up battle private listener","status":"failed","title":"should set up battle private listener","duration":8,"failureMessages":["expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  2nd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  3rd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 3\n","expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  2nd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  3rd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 3\n","expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  2nd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  3rd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 3\n"],"location":{"line":263,"column":23}},{"ancestorTitles":["","FirebaseRTDBService","listeners"],"fullName":" FirebaseRTDBService listeners should set up battle choices listener","status":"failed","title":"should set up battle choices listener","duration":8,"failureMessages":["expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  2nd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  3rd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  4th spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 4\n","expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  2nd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  3rd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  4th spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 4\n","expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  2nd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  3rd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  4th spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 4\n"],"location":{"line":275,"column":23}},{"ancestorTitles":["","FirebaseRTDBService","listeners"],"fullName":" FirebaseRTDBService listeners should set up battle resolution listener","status":"failed","title":"should set up battle resolution listener","duration":8,"failureMessages":["expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  2nd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  3rd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  4th spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  5th spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 5\n","expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  2nd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  3rd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  4th spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  5th spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 5\n","expected \"spy\" to be called with arguments: [ Anything, [Function spy] ]\n\nReceived: \n\n  1st spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  2nd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  3rd spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  4th spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n  5th spy call:\n\n  Array [\n-   Anything,\n-   [Function spy],\n+   undefined,\n+   [Function anonymous],\n  ]\n\n\nNumber of calls: 5\n"],"location":{"line":287,"column":23}},{"ancestorTitles":["","FirebaseRTDBService","deleteBattle"],"fullName":" FirebaseRTDBService deleteBattle should delete battle from RTDB","status":"passed","title":"should delete battle from RTDB","duration":1,"failureMessages":[]}],"startTime":1758701297000,"endTime":1758701297020,"status":"failed","message":"","name":"/Users/albertomunoz/Documents/Code/pokemon/src/lib/__tests__/firebase-rtdb-service.test.ts"},{"assertionResults":[{"ancestorTitles":["","RTDB Error Handling Tests","Connection Errors"],"fullName":" RTDB Error Handling Tests Connection Errors should handle RTDB not initialized error","status":"failed","title":"should handle RTDB not initialized error","duration":12,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":47,"column":64}},{"ancestorTitles":["","RTDB Error Handling Tests","Connection Errors"],"fullName":" RTDB Error Handling Tests Connection Errors should handle network connection errors","status":"failed","title":"should handle network connection errors","duration":11,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":65,"column":64}},{"ancestorTitles":["","RTDB Error Handling Tests","Connection Errors"],"fullName":" RTDB Error Handling Tests Connection Errors should handle timeout errors","status":"failed","title":"should handle timeout errors","duration":11,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":79,"column":64}},{"ancestorTitles":["","RTDB Error Handling Tests","Authentication Errors"],"fullName":" RTDB Error Handling Tests Authentication Errors should handle unauthenticated user errors","status":"failed","title":"should handle unauthenticated user errors","duration":3,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":93,"column":64}},{"ancestorTitles":["","RTDB Error Handling Tests","Authentication Errors"],"fullName":" RTDB Error Handling Tests Authentication Errors should handle permission denied errors","status":"failed","title":"should handle permission denied errors","duration":3,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":105,"column":64}},{"ancestorTitles":["","RTDB Error Handling Tests","Authentication Errors"],"fullName":" RTDB Error Handling Tests Authentication Errors should handle invalid token errors","status":"failed","title":"should handle invalid token errors","duration":3,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":117,"column":64}},{"ancestorTitles":["","RTDB Error Handling Tests","Data Validation Errors"],"fullName":" RTDB Error Handling Tests Data Validation Errors should handle invalid battle ID errors","status":"failed","title":"should handle invalid battle ID errors","duration":7,"failureMessages":["expected [Function] to throw error including 'Invalid battle ID' but got 'Cannot read properties of undefined (…'","expected [Function] to throw error including 'Invalid battle ID' but got 'Cannot read properties of undefined (…'","expected [Function] to throw error including 'Invalid battle ID' but got 'Cannot read properties of undefined (…'"],"location":{"line":126,"column":7}},{"ancestorTitles":["","RTDB Error Handling Tests","Data Validation Errors"],"fullName":" RTDB Error Handling Tests Data Validation Errors should handle invalid user ID errors","status":"failed","title":"should handle invalid user ID errors","duration":7,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":136,"column":56}},{"ancestorTitles":["","RTDB Error Handling Tests","Data Validation Errors"],"fullName":" RTDB Error Handling Tests Data Validation Errors should handle invalid team data errors","status":"failed","title":"should handle invalid team data errors","duration":7,"failureMessages":["expected [Function] to throw error including 'Invalid team data' but got 'Cannot read properties of null (readi…'","expected [Function] to throw error including 'Invalid team data' but got 'Cannot read properties of null (readi…'","expected [Function] to throw error including 'Invalid team data' but got 'Cannot read properties of null (readi…'"],"location":{"line":146,"column":7}},{"ancestorTitles":["","RTDB Error Handling Tests","Data Validation Errors"],"fullName":" RTDB Error Handling Tests Data Validation Errors should handle invalid choice data errors","status":"failed","title":"should handle invalid choice data errors","duration":7,"failureMessages":["expected [Function] to throw error including 'Invalid choice data' but got 'Cannot read properties of undefined (…'","expected [Function] to throw error including 'Invalid choice data' but got 'Cannot read properties of undefined (…'","expected [Function] to throw error including 'Invalid choice data' but got 'Cannot read properties of undefined (…'"],"location":{"line":156,"column":7}},{"ancestorTitles":["","RTDB Error Handling Tests","Battle Engine Error Handling"],"fullName":" RTDB Error Handling Tests Battle Engine Error Handling should handle initialization errors","status":"failed","title":"should handle initialization errors","duration":3,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":167,"column":42}},{"ancestorTitles":["","RTDB Error Handling Tests","Battle Engine Error Handling"],"fullName":" RTDB Error Handling Tests Battle Engine Error Handling should handle choice submission errors","status":"failed","title":"should handle choice submission errors","duration":3,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":184,"column":42}},{"ancestorTitles":["","RTDB Error Handling Tests","Battle Engine Error Handling"],"fullName":" RTDB Error Handling Tests Battle Engine Error Handling should handle state conversion errors","status":"failed","title":"should handle state conversion errors","duration":3,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":205,"column":42}},{"ancestorTitles":["","RTDB Error Handling Tests","Flow Engine Error Handling"],"fullName":" RTDB Error Handling Tests Flow Engine Error Handling should handle move submission errors","status":"passed","title":"should handle move submission errors","duration":6,"failureMessages":[]},{"ancestorTitles":["","RTDB Error Handling Tests","Flow Engine Error Handling"],"fullName":" RTDB Error Handling Tests Flow Engine Error Handling should handle switch submission errors","status":"passed","title":"should handle switch submission errors","duration":7,"failureMessages":["expected [Function] to throw error including 'Switch submission failed' but got 'Battle not initialized'"],"location":{"line":250,"column":7}},{"ancestorTitles":["","RTDB Error Handling Tests","Flow Engine Error Handling"],"fullName":" RTDB Error Handling Tests Flow Engine Error Handling should handle battle state retrieval errors","status":"failed","title":"should handle battle state retrieval errors","duration":7,"failureMessages":["expected [Function] to throw an error","expected [Function] to throw an error","expected [Function] to throw an error"],"location":{"line":264,"column":49}},{"ancestorTitles":["","RTDB Error Handling Tests","Recovery and Retry Logic"],"fullName":" RTDB Error Handling Tests Recovery and Retry Logic should retry failed operations","status":"failed","title":"should retry failed operations","duration":2,"failureMessages":["expected +0 to be 3 // Object.is equality","expected +0 to be 3 // Object.is equality","expected +0 to be 3 // Object.is equality"],"location":{"line":300,"column":28}},{"ancestorTitles":["","RTDB Error Handling Tests","Recovery and Retry Logic"],"fullName":" RTDB Error Handling Tests Recovery and Retry Logic should handle partial failures gracefully","status":"failed","title":"should handle partial failures gracefully","duration":2,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":316,"column":64}},{"ancestorTitles":["","RTDB Error Handling Tests","Recovery and Retry Logic"],"fullName":" RTDB Error Handling Tests Recovery and Retry Logic should handle concurrent operation failures","status":"failed","title":"should handle concurrent operation failures","duration":2,"failureMessages":["expected 'fulfilled' to be 'rejected' // Object.is equality","expected 'fulfilled' to be 'rejected' // Object.is equality","expected 'fulfilled' to be 'rejected' // Object.is equality"],"location":{"line":342,"column":31}},{"ancestorTitles":["","RTDB Error Handling Tests","Data Corruption Handling"],"fullName":" RTDB Error Handling Tests Data Corruption Handling should handle corrupted battle data","status":"failed","title":"should handle corrupted battle data","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":351,"column":42}},{"ancestorTitles":["","RTDB Error Handling Tests","Data Corruption Handling"],"fullName":" RTDB Error Handling Tests Data Corruption Handling should handle missing required fields","status":"failed","title":"should handle missing required fields","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":379,"column":42}},{"ancestorTitles":["","RTDB Error Handling Tests","Resource Cleanup Errors"],"fullName":" RTDB Error Handling Tests Resource Cleanup Errors should handle cleanup errors gracefully","status":"failed","title":"should handle cleanup errors gracefully","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":424,"column":42}},{"ancestorTitles":["","RTDB Error Handling Tests","Resource Cleanup Errors"],"fullName":" RTDB Error Handling Tests Resource Cleanup Errors should handle multiple destroy calls gracefully","status":"failed","title":"should handle multiple destroy calls gracefully","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":437,"column":42}}],"startTime":1758701295687,"endTime":1758701295725,"status":"failed","message":"","name":"/Users/albertomunoz/Documents/Code/pokemon/src/lib/__tests__/rtdb-error-handling.test.ts"},{"assertionResults":[{"ancestorTitles":["","RTDB Integration Tests","Complete Battle Flow Integration"],"fullName":" RTDB Integration Tests Complete Battle Flow Integration should handle full battle lifecycle from lobby to completion","status":"failed","title":"should handle full battle lifecycle from lobby to completion","duration":7,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":95,"column":42}},{"ancestorTitles":["","RTDB Integration Tests","Complete Battle Flow Integration"],"fullName":" RTDB Integration Tests Complete Battle Flow Integration should handle multiple concurrent battles","status":"failed","title":"should handle multiple concurrent battles","duration":7,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":141,"column":42}},{"ancestorTitles":["","RTDB Integration Tests","Real-time Synchronization"],"fullName":" RTDB Integration Tests Real-time Synchronization should synchronize state changes across multiple clients","status":"failed","title":"should synchronize state changes across multiple clients","duration":2,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":169,"column":42}},{"ancestorTitles":["","RTDB Integration Tests","Real-time Synchronization"],"fullName":" RTDB Integration Tests Real-time Synchronization should handle rapid state changes","status":"failed","title":"should handle rapid state changes","duration":2,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":216,"column":42}},{"ancestorTitles":["","RTDB Integration Tests","Data Consistency"],"fullName":" RTDB Integration Tests Data Consistency should maintain data consistency across operations","status":"failed","title":"should maintain data consistency across operations","duration":7,"failureMessages":["Cannot read properties of undefined (reading 'val')","Cannot read properties of undefined (reading 'val')","Cannot read properties of undefined (reading 'val')"],"location":{"line":274,"column":47}},{"ancestorTitles":["","RTDB Integration Tests","Data Consistency"],"fullName":" RTDB Integration Tests Data Consistency should handle data validation errors gracefully","status":"failed","title":"should handle data validation errors gracefully","duration":7,"failureMessages":["expected [Function] to throw error including 'Invalid battle ID' but got 'Cannot read properties of undefined (…'","expected [Function] to throw error including 'Invalid battle ID' but got 'Cannot read properties of undefined (…'","expected [Function] to throw error including 'Invalid battle ID' but got 'Cannot read properties of undefined (…'"],"location":{"line":304,"column":7}},{"ancestorTitles":["","RTDB Integration Tests","Error Recovery"],"fullName":" RTDB Integration Tests Error Recovery should recover from temporary failures","status":"failed","title":"should recover from temporary failures","duration":10,"failureMessages":["expected +0 to be 3 // Object.is equality","expected +0 to be 3 // Object.is equality","expected +0 to be 3 // Object.is equality"],"location":{"line":343,"column":28}},{"ancestorTitles":["","RTDB Integration Tests","Error Recovery"],"fullName":" RTDB Integration Tests Error Recovery should handle partial system failures","status":"failed","title":"should handle partial system failures","duration":9,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":358,"column":64}},{"ancestorTitles":["","RTDB Integration Tests","Performance Under Load"],"fullName":" RTDB Integration Tests Performance Under Load should handle high-frequency operations","status":"passed","title":"should handle high-frequency operations","duration":3,"failureMessages":[]},{"ancestorTitles":["","RTDB Integration Tests","Performance Under Load"],"fullName":" RTDB Integration Tests Performance Under Load should handle large data transfers","status":"passed","title":"should handle large data transfers","duration":3,"failureMessages":[]},{"ancestorTitles":["","RTDB Integration Tests","Concurrent Access"],"fullName":" RTDB Integration Tests Concurrent Access should handle concurrent access to same battle","status":"failed","title":"should handle concurrent access to same battle","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":429,"column":42}},{"ancestorTitles":["","RTDB Integration Tests","Concurrent Access"],"fullName":" RTDB Integration Tests Concurrent Access should handle concurrent access to different battles","status":"failed","title":"should handle concurrent access to different battles","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":460,"column":42}}],"startTime":1758701296174,"endTime":1758701296212,"status":"failed","message":"","name":"/Users/albertomunoz/Documents/Code/pokemon/src/lib/__tests__/rtdb-integration.test.ts"},{"assertionResults":[{"ancestorTitles":["","RTDB Migration Tests","Data Migration"],"fullName":" RTDB Migration Tests Data Migration should migrate Firestore battle data to RTDB format","status":"failed","title":"should migrate Firestore battle data to RTDB format","duration":11,"failureMessages":["[Function createBattle] is not a spy or a call to a spy!","[Function createBattle] is not a spy or a call to a spy!","[Function createBattle] is not a spy or a call to a spy!"],"location":{"line":95,"column":40}},{"ancestorTitles":["","RTDB Migration Tests","Data Migration"],"fullName":" RTDB Migration Tests Data Migration should migrate user presence data","status":"failed","title":"should migrate user presence data","duration":11,"failureMessages":["[Function updatePresence] is not a spy or a call to a spy!","[Function updatePresence] is not a spy or a call to a spy!","[Function updatePresence] is not a spy or a call to a spy!"],"location":{"line":112,"column":42}},{"ancestorTitles":["","RTDB Migration Tests","Data Migration"],"fullName":" RTDB Migration Tests Data Migration should migrate lobby data","status":"failed","title":"should migrate lobby data","duration":11,"failureMessages":["[Function joinLobby] is not a spy or a call to a spy!","[Function joinLobby] is not a spy or a call to a spy!","[Function joinLobby] is not a spy or a call to a spy!"],"location":{"line":124,"column":37}},{"ancestorTitles":["","RTDB Migration Tests","Component Migration"],"fullName":" RTDB Migration Tests Component Migration should migrate from Firestore battle component to RTDB component","status":"failed","title":"should migrate from Firestore battle component to RTDB component","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":134,"column":42}},{"ancestorTitles":["","RTDB Migration Tests","Component Migration"],"fullName":" RTDB Migration Tests Component Migration should migrate battle flow engine","status":"failed","title":"should migrate battle flow engine","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":177,"column":42}},{"ancestorTitles":["","RTDB Migration Tests","State Migration"],"fullName":" RTDB Migration Tests State Migration should migrate battle state from Firestore to RTDB format","status":"failed","title":"should migrate battle state from Firestore to RTDB format","duration":3,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":228,"column":42}},{"ancestorTitles":["","RTDB Migration Tests","State Migration"],"fullName":" RTDB Migration Tests State Migration should handle state migration errors gracefully","status":"failed","title":"should handle state migration errors gracefully","duration":3,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":340,"column":42}},{"ancestorTitles":["","RTDB Migration Tests","Rollback Testing"],"fullName":" RTDB Migration Tests Rollback Testing should be able to rollback to Firestore system","status":"passed","title":"should be able to rollback to Firestore system","duration":3,"failureMessages":["expected \"spy\" to be called at least once"],"location":{"line":379,"column":45}},{"ancestorTitles":["","RTDB Migration Tests","Rollback Testing"],"fullName":" RTDB Migration Tests Rollback Testing should handle mixed system state during migration","status":"passed","title":"should handle mixed system state during migration","duration":2,"failureMessages":[]},{"ancestorTitles":["","RTDB Migration Tests","Performance Comparison"],"fullName":" RTDB Migration Tests Performance Comparison should compare Firestore vs RTDB performance","status":"passed","title":"should compare Firestore vs RTDB performance","duration":1,"failureMessages":[]},{"ancestorTitles":["","RTDB Migration Tests","Performance Comparison"],"fullName":" RTDB Migration Tests Performance Comparison should measure memory usage during migration","status":"passed","title":"should measure memory usage during migration","duration":1,"failureMessages":[]},{"ancestorTitles":["","RTDB Migration Tests","Data Validation"],"fullName":" RTDB Migration Tests Data Validation should validate migrated data integrity","status":"failed","title":"should validate migrated data integrity","duration":2,"failureMessages":["[Function createBattle] is not a spy or a call to a spy!","[Function createBattle] is not a spy or a call to a spy!","[Function createBattle] is not a spy or a call to a spy!"],"location":{"line":475,"column":40}},{"ancestorTitles":["","RTDB Migration Tests","Data Validation"],"fullName":" RTDB Migration Tests Data Validation should handle data corruption during migration","status":"passed","title":"should handle data corruption during migration","duration":1,"failureMessages":[]}],"startTime":1758701295687,"endTime":1758701295709,"status":"failed","message":"","name":"/Users/albertomunoz/Documents/Code/pokemon/src/lib/__tests__/rtdb-migration.test.ts"},{"assertionResults":[{"ancestorTitles":["","RTDB Performance Tests","Connection Performance"],"fullName":" RTDB Performance Tests Connection Performance should establish connection quickly","status":"passed","title":"should establish connection quickly","duration":1,"failureMessages":[]},{"ancestorTitles":["","RTDB Performance Tests","Connection Performance"],"fullName":" RTDB Performance Tests Connection Performance should handle multiple concurrent connections","status":"passed","title":"should handle multiple concurrent connections","duration":1,"failureMessages":[]},{"ancestorTitles":["","RTDB Performance Tests","Connection Performance"],"fullName":" RTDB Performance Tests Connection Performance should handle connection failures gracefully","status":"passed","title":"should handle connection failures gracefully","duration":1,"failureMessages":[]},{"ancestorTitles":["","RTDB Performance Tests","Data Transfer Performance"],"fullName":" RTDB Performance Tests Data Transfer Performance should transfer small data quickly","status":"passed","title":"should transfer small data quickly","duration":4,"failureMessages":[]},{"ancestorTitles":["","RTDB Performance Tests","Data Transfer Performance"],"fullName":" RTDB Performance Tests Data Transfer Performance should transfer large battle data efficiently","status":"passed","title":"should transfer large battle data efficiently","duration":4,"failureMessages":[]},{"ancestorTitles":["","RTDB Performance Tests","Data Transfer Performance"],"fullName":" RTDB Performance Tests Data Transfer Performance should handle multiple small updates efficiently","status":"failed","title":"should handle multiple small updates efficiently","duration":6,"failureMessages":["Cannot read properties of undefined (reading 'val')","Cannot read properties of undefined (reading 'val')","Cannot read properties of undefined (reading 'val')"],"location":{"line":274,"column":47}},{"ancestorTitles":["","RTDB Performance Tests","Memory Usage"],"fullName":" RTDB Performance Tests Memory Usage should not leak memory with multiple battle engines","status":"passed","title":"should not leak memory with multiple battle engines","duration":1,"failureMessages":[]},{"ancestorTitles":["","RTDB Performance Tests","Memory Usage"],"fullName":" RTDB Performance Tests Memory Usage should clean up listeners properly","status":"failed","title":"should clean up listeners properly","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":197,"column":42}},{"ancestorTitles":["","RTDB Performance Tests","Battle Engine Performance"],"fullName":" RTDB Performance Tests Battle Engine Performance should initialize battle engine quickly","status":"failed","title":"should initialize battle engine quickly","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":218,"column":42}},{"ancestorTitles":["","RTDB Performance Tests","Battle Engine Performance"],"fullName":" RTDB Performance Tests Battle Engine Performance should handle rapid state changes efficiently","status":"failed","title":"should handle rapid state changes efficiently","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":236,"column":42}},{"ancestorTitles":["","RTDB Performance Tests","Battle Engine Performance"],"fullName":" RTDB Performance Tests Battle Engine Performance should handle concurrent battle engines efficiently","status":"failed","title":"should handle concurrent battle engines efficiently","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":273,"column":42}},{"ancestorTitles":["","RTDB Performance Tests","Network Resilience"],"fullName":" RTDB Performance Tests Network Resilience should handle network delays gracefully","status":"passed","title":"should handle network delays gracefully","duration":100,"failureMessages":[]},{"ancestorTitles":["","RTDB Performance Tests","Network Resilience"],"fullName":" RTDB Performance Tests Network Resilience should handle network failures gracefully","status":"passed","title":"should handle network failures gracefully","duration":101,"failureMessages":["expected 100 to be less than 50"],"location":{"line":333,"column":27}},{"ancestorTitles":["","RTDB Performance Tests","Network Resilience"],"fullName":" RTDB Performance Tests Network Resilience should handle partial network failures","status":"passed","title":"should handle partial network failures","duration":101,"failureMessages":[]},{"ancestorTitles":["","RTDB Performance Tests","Scalability"],"fullName":" RTDB Performance Tests Scalability should handle large number of battles","status":"failed","title":"should handle large number of battles","duration":1,"failureMessages":["rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function","rtdbService.onBattleMeta.mockReturnValue is not a function"],"location":{"line":377,"column":42}},{"ancestorTitles":["","RTDB Performance Tests","Scalability"],"fullName":" RTDB Performance Tests Scalability should handle large team data efficiently","status":"passed","title":"should handle large team data efficiently","duration":1,"failureMessages":[]}],"startTime":1758701296359,"endTime":1758701296473,"status":"failed","message":"","name":"/Users/albertomunoz/Documents/Code/pokemon/src/lib/__tests__/rtdb-performance.test.ts"},{"assertionResults":[{"ancestorTitles":["","RTDB Security Rules Tests","Authentication Requirements"],"fullName":" RTDB Security Rules Tests Authentication Requirements should require authentication for all operations","status":"failed","title":"should require authentication for all operations","duration":7,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":47,"column":64}},{"ancestorTitles":["","RTDB Security Rules Tests","Presence Rules"],"fullName":" RTDB Security Rules Tests Presence Rules should only allow users to update their own presence","status":"failed","title":"should only allow users to update their own presence","duration":5,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":76,"column":65}},{"ancestorTitles":["","RTDB Security Rules Tests","Presence Rules"],"fullName":" RTDB Security Rules Tests Presence Rules should validate presence data structure","status":"passed","title":"should validate presence data structure","duration":5,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":76,"column":65}},{"ancestorTitles":["","RTDB Security Rules Tests","Lobby Rules"],"fullName":" RTDB Security Rules Tests Lobby Rules should only allow users to join/leave their own lobby entries","status":"failed","title":"should only allow users to join/leave their own lobby entries","duration":1,"failureMessages":["promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting","promise resolved \"undefined\" instead of rejecting"],"location":{"line":120,"column":73}},{"ancestorTitles":["","RTDB Security Rules Tests","Lobby Rules"],"fullName":" RTDB Security Rules Tests Lobby Rules should validate lobby data structure","status":"passed","title":"should validate lobby data structure","duration":1,"failureMessages":[]},{"ancestorTitles":["","RTDB Security Rules Tests","Battle Rules"],"fullName":" RTDB Security Rules Tests Battle Rules should only allow battle participants to access battle data","status":"failed","title":"should only allow battle participants to access battle data","duration":6,"failureMessages":["You must provide a Promise to expect() when using .resolves, not 'undefined'.","You must provide a Promise to expect() when using .resolves, not 'undefined'.","You must provide a Promise to expect() when using .resolves, not 'undefined'."],"location":{"line":171,"column":67}},{"ancestorTitles":["","RTDB Security Rules Tests","Battle Rules"],"fullName":" RTDB Security Rules Tests Battle Rules should only allow choice submission during choosing phase","status":"failed","title":"should only allow choice submission during choosing phase","duration":6,"failureMessages":["promise rejected \"TypeError: Cannot read properties of unde…\" instead of resolving","promise rejected \"TypeError: Cannot read properties of unde…\" instead of resolving","promise rejected \"TypeError: Cannot read properties of unde…\" instead of resolving"],"location":{"line":198,"column":86}},{"ancestorTitles":["","RTDB Security Rules Tests","Battle Rules"],"fullName":" RTDB Security Rules Tests Battle Rules should validate choice data structure","status":"failed","title":"should validate choice data structure","duration":6,"failureMessages":["promise rejected \"TypeError: Cannot read properties of unde…\" instead of resolving","promise rejected \"TypeError: Cannot read properties of unde…\" instead of resolving","promise rejected \"TypeError: Cannot read properties of unde…\" instead of resolving"],"location":{"line":229,"column":85}},{"ancestorTitles":["","RTDB Security Rules Tests","Battle Rules"],"fullName":" RTDB Security Rules Tests Battle Rules should prevent duplicate choice submissions","status":"failed","title":"should prevent duplicate choice submissions","duration":5,"failureMessages":["promise rejected \"TypeError: Cannot read properties of unde…\" instead of resolving","promise rejected \"TypeError: Cannot read properties of unde…\" instead of resolving","promise rejected \"TypeError: Cannot read properties of unde…\" instead of resolving"],"location":{"line":267,"column":81}},{"ancestorTitles":["","RTDB Security Rules Tests","Battle Rules"],"fullName":" RTDB Security Rules Tests Battle Rules should validate client version for choice submissions","status":"failed","title":"should validate client version for choice submissions","duration":5,"failureMessages":["promise rejected \"TypeError: Cannot read properties of unde…\" instead of resolving","promise rejected \"TypeError: Cannot read properties of unde…\" instead of resolving","promise rejected \"TypeError: Cannot read properties of unde…\" instead of resolving"],"location":{"line":293,"column":81}},{"ancestorTitles":["","RTDB Security Rules Tests","Data Validation"],"fullName":" RTDB Security Rules Tests Data Validation should validate Pokemon data structure in battle creation","status":"passed","title":"should validate Pokemon data structure in battle creation","duration":1,"failureMessages":[]},{"ancestorTitles":["","RTDB Security Rules Tests","Data Validation"],"fullName":" RTDB Security Rules Tests Data Validation should validate battle metadata structure","status":"passed","title":"should validate battle metadata structure","duration":1,"failureMessages":[]},{"ancestorTitles":["","RTDB Security Rules Tests","Access Control"],"fullName":" RTDB Security Rules Tests Access Control should prevent unauthorized access to private battle data","status":"failed","title":"should prevent unauthorized access to private battle data","duration":9,"failureMessages":["You must provide a Promise to expect() when using .rejects, not 'undefined'.","You must provide a Promise to expect() when using .rejects, not 'undefined'.","You must provide a Promise to expect() when using .rejects, not 'undefined'."],"location":{"line":404,"column":83}},{"ancestorTitles":["","RTDB Security Rules Tests","Access Control"],"fullName":" RTDB Security Rules Tests Access Control should prevent unauthorized access to battle meta","status":"failed","title":"should prevent unauthorized access to battle meta","duration":9,"failureMessages":["You must provide a Promise to expect() when using .rejects, not 'undefined'.","You must provide a Promise to expect() when using .rejects, not 'undefined'.","You must provide a Promise to expect() when using .rejects, not 'undefined'."],"location":{"line":421,"column":67}},{"ancestorTitles":["","RTDB Security Rules Tests","Access Control"],"fullName":" RTDB Security Rules Tests Access Control should prevent unauthorized access to battle public state","status":"failed","title":"should prevent unauthorized access to battle public state","duration":9,"failureMessages":["You must provide a Promise to expect() when using .rejects, not 'undefined'.","You must provide a Promise to expect() when using .rejects, not 'undefined'.","You must provide a Promise to expect() when using .rejects, not 'undefined'."],"location":{"line":438,"column":69}},{"ancestorTitles":["","RTDB Security Rules Tests","Write Protection"],"fullName":" RTDB Security Rules Tests Write Protection should prevent direct writes to battle meta","status":"passed","title":"should prevent direct writes to battle meta","duration":1,"failureMessages":[]},{"ancestorTitles":["","RTDB Security Rules Tests","Write Protection"],"fullName":" RTDB Security Rules Tests Write Protection should prevent direct writes to battle public state","status":"passed","title":"should prevent direct writes to battle public state","duration":1,"failureMessages":[]},{"ancestorTitles":["","RTDB Security Rules Tests","Write Protection"],"fullName":" RTDB Security Rules Tests Write Protection should prevent direct writes to battle private state","status":"passed","title":"should prevent direct writes to battle private state","duration":1,"failureMessages":[]}],"startTime":1758701295685,"endTime":1758701295717,"status":"failed","message":"","name":"/Users/albertomunoz/Documents/Code/pokemon/src/lib/__tests__/rtdb-security-rules.test.ts"},{"assertionResults":[],"startTime":1758701294831,"endTime":1758701294831,"status":"passed","message":"","name":"/Users/albertomunoz/Documents/Code/pokemon/src/components/__tests__/HelpAssistant.test.tsx"},{"assertionResults":[{"ancestorTitles":["","RTDBBattleComponent","initialization"],"fullName":" RTDBBattleComponent initialization should initialize battle engine on mount","status":"failed","title":"should initialize battle engine on mount","duration":43,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","initialization"],"fullName":" RTDBBattleComponent initialization should show loading state initially","status":"failed","title":"should show loading state initially","duration":43,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","initialization"],"fullName":" RTDBBattleComponent initialization should show error state if initialization fails","status":"failed","title":"should show error state if initialization fails","duration":43,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","battle display"],"fullName":" RTDBBattleComponent battle display should display battle phase and turn","status":"failed","title":"should display battle phase and turn","duration":15,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","battle display"],"fullName":" RTDBBattleComponent battle display should display player and opponent Pokemon","status":"failed","title":"should display player and opponent Pokemon","duration":15,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","battle display"],"fullName":" RTDBBattleComponent battle display should display Pokemon HP and level","status":"failed","title":"should display Pokemon HP and level","duration":15,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","battle display"],"fullName":" RTDBBattleComponent battle display should highlight current Pokemon","status":"failed","title":"should highlight current Pokemon","duration":15,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","move selection"],"fullName":" RTDBBattleComponent move selection should display available moves","status":"failed","title":"should display available moves","duration":10,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","move selection"],"fullName":" RTDBBattleComponent move selection should submit move when clicked","status":"failed","title":"should submit move when clicked","duration":10,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","move selection"],"fullName":" RTDBBattleComponent move selection should disable moves with no PP","status":"failed","title":"should disable moves with no PP","duration":10,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","Pokemon switching"],"fullName":" RTDBBattleComponent Pokemon switching should display available Pokemon for switching","status":"failed","title":"should display available Pokemon for switching","duration":7,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","Pokemon switching"],"fullName":" RTDBBattleComponent Pokemon switching should submit switch when clicked","status":"failed","title":"should submit switch when clicked","duration":6,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","Pokemon switching"],"fullName":" RTDBBattleComponent Pokemon switching should disable current Pokemon and fainted Pokemon","status":"failed","title":"should disable current Pokemon and fainted Pokemon","duration":6,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","battle completion"],"fullName":" RTDBBattleComponent battle completion should show victory message when player wins","status":"failed","title":"should show victory message when player wins","duration":9,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","battle completion"],"fullName":" RTDBBattleComponent battle completion should show defeat message when player loses","status":"failed","title":"should show defeat message when player loses","duration":9,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","battle completion"],"fullName":" RTDBBattleComponent battle completion should call onBattleComplete when battle ends","status":"failed","title":"should call onBattleComplete when battle ends","duration":9,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","battle log"],"fullName":" RTDBBattleComponent battle log should display battle log entries","status":"failed","title":"should display battle log entries","duration":2,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","error handling"],"fullName":" RTDBBattleComponent error handling should show error message when move submission fails","status":"failed","title":"should show error message when move submission fails","duration":4,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","error handling"],"fullName":" RTDBBattleComponent error handling should show error message when switch submission fails","status":"failed","title":"should show error message when switch submission fails","duration":4,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}},{"ancestorTitles":["","RTDBBattleComponent","cleanup"],"fullName":" RTDBBattleComponent cleanup should destroy battle engine on unmount","status":"failed","title":"should destroy battle engine on unmount","duration":3,"failureMessages":["getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function","getModularInstance(...).onAuthStateChanged is not a function"],"location":{"line":198,"column":35}}],"startTime":1758701296600,"endTime":1758701296695,"status":"failed","message":"","name":"/Users/albertomunoz/Documents/Code/pokemon/src/components/__tests__/RTDBBattleComponent.test.tsx"}]}